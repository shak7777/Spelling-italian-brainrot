<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kids Pronunciation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
body{
  font-family:Arial;
  background:linear-gradient(#87CEEB,#ffffff);
  text-align:center;
  padding:20px;
}
#word{
  font-size:42px;
  border:5px solid #4CAF50;
  border-radius:15px;
  padding:20px;
  margin:10px;
  background:white;
}
button{
  font-size:18px;
  padding:12px 18px;
  margin:6px;
  border-radius:14px;
  border:none;
  background:#ff9800;
  color:white;
}
#listenBtn{background:#4CAF50;display:none;}
#resetBtn{background:#e53935;}
.correct{color:green;font-size:26px;}
.wrong{color:red;font-size:22px;}
#progressBar{width:100%;height:18px;background:#ddd;border-radius:10px;}
#progressFill{height:100%;width:0%;background:#4CAF50;}
#stickers img{width:40px;margin:3px;}
</style>
</head>

<body>

<h2>üé§ Say the Word</h2>

<div id="stars">‚≠ê 0</div>
<div id="reward"></div>
<div id="stickers">Stickers:</div>
<div id="dashboard"></div>

<div id="progressBar"><div id="progressFill"></div></div>

<div id="word"></div>

<button id="listenBtn" onclick="speakWord()">üîä Listen</button><br>
<button onclick="startListening()">üé§ Pronounce</button><br>
<button onclick="showArabic()">üìò Arabic Meaning</button><br>
<button id="resetBtn" onclick="parentReset()">üîê Parent Reset</button>

<div id="arabic"></div>
<div id="result"></div>

<script>
/* ================= WORD LIST ================= */
const words = [
"address","adjectives","advise","afford","calendar","dips","alleys","almost","amazing",
"ambulance","analog","ankle","answer","area","attic","aunt","beach","beak","beaver",
"beetle","behind","bench","blend","blind","blonde","blubber","bodies","bottom","brain",
"breaks","bright","building","burrow","cacti","calm","canal","caravan","cargo","cattle",
"celsius","challenge","change","check","children","chilly","classify","cliff","clownfish","coach",
"cocoon","colon","compare","compass","compound","concrete","corner","covering","coyote","crossword",
"currency","drama","decay","difference","digital","directions","drill","dump","earth","empty",
"ending","engine","engineers","every","excited","exercise","fabric","factory","facts","fantasy",
"farthest","favorite","feast","feathers","ferry","fiction","fields","fight","flame","flash",
"flippers","flock","fluff","flute","focus","folds","folk","follow","force","forests",
"frame","friendship","garden","gecko","gills","goals","golden","grasshopper","grouchy","group",
"guess","guide","gulf","heal","healthy","heap","herd","hibiscus","high","holiday",
"hunt","joke","jumbo","jungle","kelp","kicking","kindness","kingdom","know","labels",
"lake","leap","learner","leaves","lime","listen","litter","living","locate","loop",
"loudness","mammals","matters","maybe","members","merchant","mingle","modern","months","motion",
"mph","nervous","nibble","nouns","nowhere","numbers","object","octopus","odor","once",
"onions","outdoor","paddled","pain","pair","paradise","parents","partner","passes","patient",
"pattern","peace","pearls","penguin","people","pictures","pitch","places","point","poison",
"porcupine","port","potatoes","power","powerful","practice","predict","print","properties","property",
"proud","puddle","quick","quilt","railroad","reader","rearing","reduce","related","repeat",
"rescue","reuse","revolve","riddle","robin","rose","ruffle","scales","search","second",
"seedling","separates","shame","sharpener","shell","shine","short","shrubs","shrug","sight",
"similar","sitting","skills","skyscraper","sloppy","sniff","softer","solar","solids","solve",
"something","sound","space","sparrow","spine","spirit","sports","stamp","steel","sticky",
"straight","stream","stroll","suffix","sunlight","sunrise","surprise","swimmer","swing","syllable",
"symbol","talent","tapping","team","teenager","text","texture","thankful","think","thread",
"thrill","thumbs","timber","timeline","tonic","topic","touched","traffic","tram","transportation",
"trap","trembling","trim","trouble","trunk","trust","tuesday","twigs","uncle","vacation",
"valley","vines","waddle","wagon","weeks","weird","wetland","whip","window","wished",
"wonderful","woods","worked","write","written","young"
];

/* ================= STICKERS ================= */
const STICKER_SET = Array.from({length:54},(_,i)=>`stickers/${i+1}.png`);

/* ================= STATE ================= */
let index = Number(localStorage.getItem("kp_index")) || 0;
let stars = Number(localStorage.getItem("kp_stars")) || 0;
let earnedStickers = JSON.parse(localStorage.getItem("kp_stickers") || "[]");
let fails = 0;
const PARENT_PIN = "1234";

/* ================= ELEMENTS ================= */
const wordBox = document.getElementById("word");
const starsBox = document.getElementById("stars");
const rewardBox = document.getElementById("reward");
const stickerBox = document.getElementById("stickers");
const dash = document.getElementById("dashboard");
const bar = document.getElementById("progressFill");
const listenBtn = document.getElementById("listenBtn");
const arabicBox = document.getElementById("arabic");
const resultBox = document.getElementById("result");

/* ================= SAVE ================= */
function save(){
  localStorage.setItem("kp_index", index);
  localStorage.setItem("kp_stars", stars);
  localStorage.setItem("kp_stickers", JSON.stringify(earnedStickers));
}

/* ================= UI ================= */
function update(){
  wordBox.textContent = words[index] || "üéâ Finished!";
  starsBox.textContent = "‚≠ê " + stars;
  bar.style.width = (index / words.length * 100) + "%";
  rewardBox.textContent = "";
  renderStickers();
  dash.innerHTML = `Words: ${index}/${words.length}<br>Stars: ${stars}<br>Stickers: ${earnedStickers.length}`;
  fails = 0;
  listenBtn.style.display = "none";
}

function renderStickers(){
  stickerBox.innerHTML = "Stickers:";
  earnedStickers.forEach(s=>{
    stickerBox.innerHTML += `<img src="${s}">`;
  });
}

/* ================= RESET ================= */
function parentReset(){
  const p = prompt("Enter Parent PIN");
  if(p === PARENT_PIN && confirm("Reset all progress?")){
    index = 0; stars = 0; earnedStickers = [];
    save(); update();
  }
}

/* ================= AUDIO ================= */
let audioCtx;
function softWin(){
  if(!audioCtx) audioCtx = new AudioContext();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.frequency.value = 520;
  g.gain.value = 0.07;
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime + 0.25);
}
function failSound(){
  if(!audioCtx) audioCtx = new AudioContext();
  const o = audioCtx.createOscillator();
  o.frequency.value = 180;
  o.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime + 0.3);
}

/* ================= MATCH ================= */
function easyMatch(a,b){ return a.includes(b.slice(0,3)); }

/* ================= SPEECH ================= */
const Rec = window.SpeechRecognition || window.webkitSpeechRecognition;
const rec = new Rec();
rec.lang = "en-US";

function startListening(){
  resultBox.textContent = "üéß Listening...";
  rec.start();
}

rec.onresult = e=>{
  const said = e.results[0][0].transcript.toLowerCase();
  if(easyMatch(said, words[index])){
    softWin();
    stars++; index++;
    if(stars % 5 === 0 && earnedStickers.length < STICKER_SET.length){
      earnedStickers.push(STICKER_SET[earnedStickers.length]);
      rewardBox.textContent = "üéÅ New Sticker!";
    }
    save();
    resultBox.innerHTML = "<div class='correct'>Great!</div>";
    setTimeout(update,800);
  }else{
    failSound();
    fails++;
    resultBox.innerHTML = `<div class='wrong'>You said: ${said}</div>`;
    if(fails >= 5) listenBtn.style.display = "inline-block";
  }
};

/* ================= LISTEN ================= */
function speakWord(){
  const u = new SpeechSynthesisUtterance(words[index]);
  u.rate = 0.7;
  speechSynthesis.speak(u);
}

/* ================= ARABIC ================= */
function showArabic(){
  arabicBox.textContent = "üìò";
}

update();
</script>

</body>
</html>